{
  "id": "truecover-add-location",
  "resourceType": "Questionnaire",
  "title": "Add Location",
  "version": "0.0.1",
  "status": "active",
  "publisher": "OpenSRP",
  "subjectType": [
    "Location"
  ],
  "contact": [
    {
      "name": "http://www.opensrp.io"
    }
  ],
  "extension": [
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-targetStructureMap",
      "valueCanonical": "https://fhir.labs.smartregister.org/fhir/StructureMap/truecover-add-location-sm"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "provinces",
        "expression": "Location?partof=Location/thailand-test-location",
        "language": "application/x-fhir-query"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "province-id",
        "language": "text/fhirpath",
        "expression": "%resource.descendants().where(linkId='select-province').answer.value.reference"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "selected-province-name",
        "language": "text/fhirpath",
        "expression": "iif(%province-id.exists(), %resource.descendants().where(linkId='select-province').answer.value.display, 'District')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "district-id",
        "language": "text/fhirpath",
        "expression": "%resource.descendants().where(linkId='select-district').answer.value.reference"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "selected-district-name",
        "language": "text/fhirpath",
        "expression": "iif(%district-id.exists(), %resource.descendants().where(linkId='select-district').answer.value.display, 'Area')"
      }
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/variable",
      "valueExpression": {
        "name": "operational-area-id",
        "language": "text/fhirpath",
        "expression": "%resource.descendants().where(linkId='select-operational-area').answer.value.reference"
      }
    }
  ],
  "item": [
    {
      "linkId": "was-survey-done",
      "type": "choice",
      "text": "Was survey done",
      "required": true,
      "answerOption": [
        {
          "valueCoding": {
            "id": "29f1c80b-370c-44cd-863d-8087227a4959",
            "code": "yes",
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "display": "Yes"
          }
        },
        {
          "valueCoding": {
            "id": "3d1bff3e-313e-4934-8a4f-fed08d761b9f",
            "code": "no",
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "display": "No"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "radio-button"
              }
            ]
          }
        }
      ]
    },
    {
      "linkId": "reason-for-no-survey",
      "type": "choice",
      "text": "Reason for not doing the survey",
      "required": false,
      "answerOption": [
        {
          "valueCoding": {
            "id": "454c1b75-ed86-40e8-81e4-31d868340392",
            "code": "no-one-home",
            "system": "urn:uuid:8031e79a-096f-4691-b0b5-40ad6c725178",
            "display": "No one home"
          }
        },
        {
          "valueCoding": {
            "id": "3a4b0ef5-0c82-482a-ea33-e379828cdda6",
            "code": "person-refused",
            "system": "urn:uuid:8031e79a-096f-4691-b0b5-40ad6c725178",
            "display": "Person refused"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "radio-button"
              }
            ]
          }
        }
      ],
      "enableWhen": [
        {
          "question": "was-survey-done",
          "operator": "=",
          "answerCoding": {
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "code": "no"
          }
        }
      ]
    },
    {
      "linkId": "survey-date",
      "type": "date",
      "text": "Date of survey",
      "required": true,
      "enableWhen": [
        {
          "question": "was-survey-done",
          "operator": "=",
          "answerCoding": {
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "code": "yes"
          }
        }
      ]
    },
    {
      "linkId": "house-hold-head-name",
      "type": "string",
      "text": "Head of household name?",
      "required": true,
      "enableWhen": [
        {
          "question": "was-survey-done",
          "operator": "=",
          "answerCoding": {
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "code": "yes"
          }
        }
      ]
    },
    {
      "linkId": "phone-number",
      "type": "string",
      "text": "What is the household phone number?",
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/regex",
          "valueString": "^((\\+|00)(\\d{1,3}))?\\d{5,12}$"
        }
      ],
      "required": false,
      "enableWhen": [
        {
          "question": "was-survey-done",
          "operator": "=",
          "answerCoding": {
            "system": "urn:uuid:b544556f-af7a-435e-8ed7-238628b89ed2",
            "code": "yes"
          }
        }
      ]
    },
    {
      "linkId": "select-province",
      "text": "Province",
      "type": "reference",
      "required": true,
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/questionnaire-item-control",
                "code": "drop-down",
                "display": "Drop down"
              }
            ],
            "text": "Drop down"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-answerExpression",
          "valueExpression": {
            "expression": "Location?partof=Location/thailand-test-location",
            "language": "application/x-fhir-query"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-choiceColumn",
          "extension": [
            {
              "url": "path",
              "valueString": "name"
            },
            {
              "url": "forDisplay",
              "valueBoolean": true
            }
          ]
        }
      ]
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/questionnaire-item-control",
                "code": "drop-down",
                "display": "Drop down"
              }
            ],
            "text": "Drop down"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-answerExpression",
          "valueExpression": {
            "expression": "Location?partof={{%province-id}}",
            "language": "application/x-fhir-query"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-choiceColumn",
          "extension": [
            {
              "url": "path",
              "valueString": "name"
            },
            {
              "url": "forDisplay",
              "valueBoolean": true
            }
          ]
        }
      ],
      "linkId": "select-district",
      "text": "District",
      "_text": {
        "extension": [
          {
            "url": "http://hl7.org/fhir/StructureDefinition/cqf-expression",
            "valueExpression": {
              "language": "text/fhirpath",
              "expression": "%selected-province-name"
            }
          }
        ]
      },
      "type": "reference",
      "required": true
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/questionnaire-item-control",
                "code": "drop-down",
                "display": "Drop down"
              }
            ],
            "text": "Drop down"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-answerExpression",
          "valueExpression": {
            "expression": "Location?partof={{%district-id}}",
            "language": "application/x-fhir-query"
          }
        },
        {
          "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-choiceColumn",
          "extension": [
            {
              "url": "path",
              "valueString": "name"
            },
            {
              "url": "forDisplay",
              "valueBoolean": true
            }
          ]
        }
      ],
      "linkId": "select-operational-area",
      "text": "Area",
      "_text": {
        "extension": [
          {
            "url": "http://hl7.org/fhir/StructureDefinition/cqf-expression",
            "valueExpression": {
              "language": "text/fhirpath",
              "expression": "%selected-district-name"
            }
          }
        ]
      },
      "type": "reference",
      "required": true
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": false
        }
      ],
      "linkId": "positionLongitude",
      "type": "string",
      "text": "Longitude",
      "readOnly": true,
      "required": false
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": false
        }
      ],
      "linkId": "positionLatitude",
      "text": "Latitude",
      "type": "string",
      "readOnly": true,
      "required": false
    },
    {
      "linkId": "father-education-status",
      "type": "choice",
      "text": "Education status of father",
      "required": false,
      "answerOption": [
        {
          "valueCoding": {
            "id": "71aead36-b4ce-4c8f-8456-a0a621928c4f",
            "code": "primary",
            "system": "urn:uuid:1b8d5977-48b9-4b50-c15f-4a0df4b06e03",
            "display": "Primary"
          }
        },
        {
          "valueCoding": {
            "id": "bec12eca-478b-4870-8fdd-e14ff5a0e8c1",
            "code": "secondary",
            "system": "urn:uuid:1b8d5977-48b9-4b50-c15f-4a0df4b06e03",
            "display": "Secondary"
          }
        },
        {
          "valueCoding": {
            "id": "f20b7a73-f553-4b49-8653-cad8e0ece485",
            "code": "university",
            "system": "urn:uuid:1b8d5977-48b9-4b50-c15f-4a0df4b06e03",
            "display": "University"
          }
        },
        {
          "valueCoding": {
            "id": "1f81a245-9b11-42e2-9a35-a1c703a1c745",
            "code": "none",
            "system": "urn:uuid:1b8d5977-48b9-4b50-c15f-4a0df4b06e03",
            "display": "None"
          }
        },
        {
          "valueCoding": {
            "id": "39d80718-fc44-47ae-832e-64844e91f4e3",
            "code": "don't-know",
            "system": "urn:uuid:1b8d5977-48b9-4b50-c15f-4a0df4b06e03",
            "display": "Don't Know"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "drop-down"
              }
            ]
          }
        }
      ]
    },
    {
      "linkId": "mother-education-status",
      "type": "choice",
      "text": "Education status of mother",
      "required": false,
      "answerOption": [
        {
          "valueCoding": {
            "id": "5a7a5453-d6d5-4eb0-e177-13fb90a6eb45",
            "code": "primary",
            "system": "urn:uuid:d5927f97-cee7-4b43-b8d9-332736393dd7",
            "display": "Primary"
          }
        },
        {
          "valueCoding": {
            "id": "567fc354-1df7-45e0-8932-83073ed77353",
            "code": "secondary",
            "system": "urn:uuid:d5927f97-cee7-4b43-b8d9-332736393dd7",
            "display": "Secondary"
          }
        },
        {
          "valueCoding": {
            "id": "12159d52-2907-4a57-8c26-5e5ccadfd744",
            "code": "university",
            "system": "urn:uuid:d5927f97-cee7-4b43-b8d9-332736393dd7",
            "display": "University"
          }
        },
        {
          "valueCoding": {
            "id": "fa45df37-589e-4c28-c266-c3d0a0079c98",
            "code": "none",
            "system": "urn:uuid:d5927f97-cee7-4b43-b8d9-332736393dd7",
            "display": "None"
          }
        },
        {
          "valueCoding": {
            "id": "3bccbbac-d91d-4580-8fb7-c9cfb0caad40",
            "code": "don't-know",
            "system": "urn:uuid:d5927f97-cee7-4b43-b8d9-332736393dd7",
            "display": "Don't Know"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "drop-down"
              }
            ]
          }
        }
      ]
    },
    {
      "linkId": "mobile-phone-ownership",
      "type": "choice",
      "text": "Do you own a mobile phone",
      "required": false,
      "answerOption": [
        {
          "valueCoding": {
            "id": "63c3c6c6-b474-4277-d289-5e71bd992464",
            "code": "yes",
            "system": "urn:uuid:3f14ce4c-4d90-4350-8087-1d7817923d5b",
            "display": "Yes"
          }
        },
        {
          "valueCoding": {
            "id": "5905df2e-599a-4f52-8147-ff11541e6416",
            "code": "no",
            "system": "urn:uuid:3f14ce4c-4d90-4350-8087-1d7817923d5b",
            "display": "No"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "radio-button"
              }
            ]
          }
        }
      ]
    },
    {
      "linkId": "household-size",
      "type": "integer",
      "text": "How many people are in this household",
      "required": false
    },
    {
      "linkId": "internet-access",
      "type": "choice",
      "text": "Do you have access to the internet",
      "required": false,
      "answerOption": [
        {
          "valueCoding": {
            "id": "cceff5ad-fe88-4518-c3c5-3eaa4e69035d",
            "code": "yes",
            "system": "urn:uuid:3cdc7687-8ed2-4bfa-8b7e-0baa7712eeb6",
            "display": "Yes"
          }
        },
        {
          "valueCoding": {
            "id": "b6aa0a88-09a2-42f8-a34b-df7279980208",
            "code": "no",
            "system": "urn:uuid:3cdc7687-8ed2-4bfa-8b7e-0baa7712eeb6",
            "display": "No"
          }
        }
      ],
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
          "valueCodeableConcept": {
            "coding": [
              {
                "system": "http://hl7.org/fhir/ValueSet/questionnaire-item-control",
                "code": "radio-button"
              }
            ]
          }
        }
      ]
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": true
        }
      ],
      "linkId": "location-id",
      "text": "Location ID",
      "type": "string",
      "readOnly": true,
      "required": false
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": true
        }
      ],
      "linkId": "group-id",
      "text": "Group ID",
      "type": "string",
      "readOnly": true,
      "required": false
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": true
        }
      ],
      "linkId": "list-id",
      "text": "List ID",
      "type": "string",
      "readOnly": true,
      "required": false
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-hidden",
          "valueBoolean": true
        }
      ],
      "linkId": "task-id",
      "text": "Task ID",
      "type": "string",
      "readOnly": true,
      "required": false
    }
  ]
}